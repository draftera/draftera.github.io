---
title: "test"
categories:
tags:
---

<h2>1D Finite Volume Example</h2>

<p>
We discretize the flux term:
$$ \frac{du_i}{dt} = - \frac{F_{i+1/2} - F_{i-1/2}}{\Delta x} $$
</p>

<div>
  <label>Flux coefficient:
    <input type="range" id="flux" min="0" max="5" step="0.1" value="2">
  </label>
</div>

<svg id="fvmViz" width="500" height="200"></svg>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
let svg = d3.select("#fvmViz");
let width = +svg.attr("width"), height = +svg.attr("height");

let cells = d3.range(5).map(i => ({x: 50 + i*80, y: 100}));

svg.selectAll("rect")
  .data(cells)
  .enter()
  .append("rect")
  .attr("x", d => d.x - 30)
  .attr("y", d => d.y - 30)
  .attr("width", 60)
  .attr("height", 60)
  .attr("fill", "#eef")
  .attr("stroke", "#333");

let arrow = svg.append("line")
  .attr("x1", 50)
  .attr("y1", 100)
  .attr("x2", 130)
  .attr("y2", 100)
  .attr("stroke", "red")
  .attr("stroke-width", 3)
  .attr("marker-end", "url(#arrow)");

svg.append("defs").append("marker")
  .attr("id", "arrow")
  .attr("viewBox", "0 -5 10 10")
  .attr("refX", 10)
  .attr("refY", 0)
  .attr("markerWidth", 4)
  .attr("markerHeight", 4)
  .attr("orient", "auto")
  .append("path")
  .attr("d", "M0,-5L10,0L0,5")
  .attr("fill", "red");

d3.select("#flux").on("input", function() {
  let v = +this.value * 10;
  arrow.attr("x2", 50 + v);
});
</script>
